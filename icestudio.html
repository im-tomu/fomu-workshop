<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>Fomu on IceStudio Nightly &#8212; FPGA Tomu (Fomu) Workshop  documentation</title>

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/material-icons.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/session.css" />
    <link rel="stylesheet" href="_static/notosanscjkjp.css" type="text/css" />
    <link rel="stylesheet" href="_static/roboto.css" type="text/css" />
    <link rel="stylesheet" href="_static/material-design-lite-1.3.0/material.blue-orange.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx_symbiflow_theme.css" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/sphinx_symbiflow_theme.js"></script>
    <link rel="shortcut icon" href="_static/icon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working with LiteX and (co-)simulation with Renode" href="renode.html" />
    <link rel="prev" title="Migen and LiteX" href="migen.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="hdl.html">Hardware Description Languages</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active">Fomu on IceStudio <em>Nightly</em></a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
            <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="_sources/icestudio.rst.txt" rel="nofollow">
<i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
          <a  class="mdl-navigation__link" href="index.html">
                  <i class="material-icons navigation-link-icon">home</i>
                  Workshop Home
              </a>
          
              <a  class="mdl-navigation__link" href="https://fomu.im">
                  <i class="material-icons navigation-link-icon">web</i>
                  Website
              </a>
          
              <a  class="mdl-navigation__link" href="https://github.com/im-tomu/fomu-workshop">
                  <i class="material-icons navigation-link-icon">code</i>
                  GitHub
              </a>
          
              <a  class="mdl-navigation__link" href="https://github.com/im-tomu/fomu-workshop/issues/new">
                  <i class="material-icons navigation-link-icon">bug_report</i>
                  Report Issue
              </a>
          
              <a  class="mdl-navigation__link" href="https://j.mp/fomu-cs">
                  <i class="material-icons navigation-link-icon">shopping_cart</i>
                  Buy
              </a>
          <a  class="mdl-navigation__link" href="help.html">
                  <i class="material-icons navigation-link-icon">live_help</i>
                  Contact
              </a>
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="index.html">
              <img class="logo" src="_static/logo.png" alt="FPGA Tomu (Fomu) Workshop"/>
          </a>
      </span>
    
<div class="globaltoc">
  <span class="mdl-layout-title toc">Table Of Contents</span>
  
  
      
      <nav class="mdl-navigation">
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements/index.html">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements/files.html">Required Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/software.html">Required Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/hardware.html">Required Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/drivers.html">Required Drivers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python on Fomu</a></li>
<li class="toctree-l1"><a class="reference internal" href="riscv.html">Fomu as a CPU</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="hdl.html">Hardware Description Languages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="verilog.html">Verilog on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl.html">VHDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed-hdl.html">Mixed HDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="migen.html">Migen and LiteX</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Fomu on IceStudio <em>Nightly</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="renode.html">Working with LiteX and (co-)simulation with Renode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="renode-starting.html">Getting Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-zephyr.html">Running your own Zephyr binary on LiteX/VexRiscv in Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-bridge.html">Wishbone bridge between Renode and Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-verilator.html">Renode Co-simulation using Verilator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bootloader.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
</ul>

      </nav>
  
  </div>

</header>
        <main class="mdl-layout__content" tabIndex="0">
<header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="index.html">
              <img class="logo" src="_static/logo.png" alt="FPGA Tomu (Fomu) Workshop"/>
          </a>
      </span>
    
<div class="globaltoc">
  <span class="mdl-layout-title toc">Table Of Contents</span>
  
  
      
      <nav class="mdl-navigation">
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements/index.html">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements/files.html">Required Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/software.html">Required Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/hardware.html">Required Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/drivers.html">Required Drivers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python on Fomu</a></li>
<li class="toctree-l1"><a class="reference internal" href="riscv.html">Fomu as a CPU</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="hdl.html">Hardware Description Languages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="verilog.html">Verilog on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl.html">VHDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed-hdl.html">Mixed HDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="migen.html">Migen and LiteX</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Fomu on IceStudio <em>Nightly</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="renode.html">Working with LiteX and (co-)simulation with Renode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="renode-starting.html">Getting Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-zephyr.html">Running your own Zephyr binary on LiteX/VexRiscv in Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-bridge.html">Wishbone bridge between Renode and Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-verilator.html">Renode Co-simulation using Verilator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bootloader.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
</ul>

      </nav>
  
  </div>

</header>

    <div class="document">
        <div class="page-content">
        
  <section id="fomu-on-icestudio-nightly">
<h1>Fomu on IceStudio <em>Nightly</em><a class="headerlink" href="#fomu-on-icestudio-nightly" title="Permalink to this heading">¶</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Fomu is currently not supported in the stable releases
of IceStudio. Development or <a class="reference external" href="https://github.com/juanmard/icestudio/releases/tag/nightly">nightly</a>
releases need to be used.</p>
</div>
<section id="hello-world-blink-a-led">
<h2>“Hello world!” - Blink a LED<a class="headerlink" href="#hello-world-blink-a-led" title="Permalink to this heading">¶</a></h2>
<p>The canonical “Hello, world!” of hardware is to blink a LED. The
directory <code class="docutils literal notranslate"><span class="pre">icestudio</span></code> contains a Blinky example in ICE format.
Moreover, <code class="docutils literal notranslate"><span class="pre">Blinky_BoardTop.ice</span></code> wraps Blinky, showcasing how
to use the Design Under Test (DUT) as a black box.</p>
<p>Open <code class="docutils literal notranslate"><span class="pre">Blinky_BoardTop.ice</span></code> from <a class="reference external" href="https://juanmard.github.io/icestudio/">Icestudio</a>
and use the buttons at the botton:</p>
<a class="reference external image-reference" href="https://github.com/juanmard/icestudio"><img alt="_images/blinky_steps.png" class="align-center" src="_images/blinky_steps.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="0">
<li><p>Check that the <strong>selected board</strong> is the Fomu.</p>
<ul class="simple">
<li><p>Click on the button with a ‘microchip’ icon, and a modal window will open.</p></li>
<li><p>There, select the device (UP5K) in the first dropdown list and the board (Fomu)
in the second list.</p></li>
</ul>
</li>
<li><p>Click on the <strong>Verify</strong> button for checking the design.</p></li>
<li><p>Click on the <strong>Build</strong> button for having the design exported to Verilog, synthesised,
placed, routed and, finally, the bitstream generated.</p></li>
<li><p>Click on the <strong>Upload</strong> for sending the bitstream to the board.</p></li>
<li><p>After each of the steps is executed, the corresponding log can be shown through button
<strong>View command output</strong>.</p></li>
</ol>
<p>You should see the rainbow pattern in the Fomu as soon as the <em>Upload</em>
step is finished:</p>
<a class="reference external image-reference" href="https://github.com/juanmard/icestudio"><img alt="_images/blinky_video.gif" class="align-center" src="_images/blinky_video.gif" style="width: 600px;" /></a>
<p>However, that’s just the beginning of the trip…</p>
<section id="navigation">
<h3>Navigation<a class="headerlink" href="#navigation" title="Permalink to this heading">¶</a></h3>
<p>You can navigate the hierarchy of the design by double-clicking on the main
block. Go as deep as you want, until you find raw Verilog code. As you
can observe, ICE modules are fancy wrappers around the Verilog code from
<code class="docutils literal notranslate"><span class="pre">verilog/blink</span></code>.</p>
<a class="reference internal image-reference" href="_images/blinky.gif"><img alt="_images/blinky.gif" class="align-center" src="_images/blinky.gif" style="width: 600px;" /></a>
<p>Editing submodules is blocked by default, but you can unlock the feature
with the red button at the botton left. Do the modifications you wish,
then save the changes and go back to the top. There is a ‘Home’ button
at the bottom left for jumping to the root of the design straightaway.
From the top, you can verify, build and upload the design again.</p>
<p>You can also open or save each of the blocks as an independent project.
For instance, open <code class="docutils literal notranslate"><span class="pre">Blinky.ice</span></code>, instead of <code class="docutils literal notranslate"><span class="pre">Blinky_BoardTop.ice</span></code>:</p>
<a class="reference internal image-reference" href="_images/blinky_diagram.png"><img alt="_images/blinky_diagram.png" class="align-center" src="_images/blinky_diagram.png" style="width: 600px;" /></a>
<p>Modules are browsable, as shown in the screencast above:</p>
<a class="reference internal image-reference" href="_images/clk_buffering.png"><img alt="_images/clk_buffering.png" src="_images/clk_buffering.png" style="width: 33%;" /></a>
<a class="reference internal image-reference" href="_images/pwm_generator.png"><img alt="_images/pwm_generator.png" src="_images/pwm_generator.png" style="width: 33%;" /></a>
<a class="reference internal image-reference" href="_images/sb_rgba_drv.png"><img alt="_images/sb_rgba_drv.png" src="_images/sb_rgba_drv.png" style="width: 33%;" /></a>
</section>
<section id="board-rules">
<h3>Board rules<a class="headerlink" href="#board-rules" title="Permalink to this heading">¶</a></h3>
<p>A feature in <em>IceStudio Nightly</em> named “<em>board rules</em>” allows predefining
assignments for I/O pins. For instance, Fomu needs to disconnect its USB
communication stack when writting raw HDL. Therefore, it is always necessary
to define and set pins <em>usb_dn</em>, <em>usb_dp</em> and <em>usb_dp_pu</em>. Option
<em>board rules</em> does so, allowing a cleaner graphical desing.</p>
<p>Open <code class="docutils literal notranslate"><span class="pre">Blinky_BoardTop_rules.ice</span></code>, which is the result of using this feature
in the Blinky example. As you see, USB pins need not to be defined explicitly:</p>
<a class="reference internal image-reference" href="_images/blinky_board_rules.png"><img alt="_images/blinky_board_rules.png" class="align-center" src="_images/blinky_board_rules.png" style="width: 600px;" /></a>
<p>Instead, ensure that option <em>board rules</em> is activate in the board properties:</p>
<a class="reference internal image-reference" href="_images/blinky_board_options.gif"><img alt="_images/blinky_board_options.gif" class="align-center" src="_images/blinky_board_options.gif" style="width: 600px;" /></a>
<p>As shown in the screencast, you can inpect the specific rules applied to each
pin by using the “<em>View board rules</em>” button in the board properties window.</p>
<p>The same rules can be applied to modules lower in the hierarchy. For example, open
<code class="docutils literal notranslate"><span class="pre">Blinky_rules.ice</span></code> and compare with <code class="docutils literal notranslate"><span class="pre">Blinky_rules.ice</span></code> above:</p>
<a class="reference internal image-reference" href="_images/blinky_module_rules.png"><img alt="_images/blinky_module_rules.png" class="align-center" src="_images/blinky_module_rules.png" style="width: 600px;" /></a>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Find more info about features of IceStudio (such as collections or
plugins) in the <a class="reference external" href="https://juanmard.github.io/icestudio/index.html">documentation</a>.</p>
</div>
</section>
</section>
</section>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
<div class="localtoc">
    <p class="caption">
      <span class="caption-text">Table Of Contents</span>
    </p>
    <ul>
<li><a class="reference internal" href="#">Fomu on IceStudio <em>Nightly</em></a><ul>
<li><a class="reference internal" href="#hello-world-blink-a-led">“Hello world!” - Blink a LED</a><ul>
<li><a class="reference internal" href="#navigation">Navigation</a></li>
<li><a class="reference internal" href="#board-rules">Board rules</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="migen.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L material-icons">arrow_back</i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>Migen and LiteX</div>
         </div>
     </a>
     <a id="button-next" href="renode.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
        <i class="pagenation-arrow-R material-icons">arrow_forward</i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>Working with LiteX and (co-)simulation with Renode</div>
        </div>
     </a>
</div>
        <footer class="mdl-mini-footer">
  <div class="mdl-mini-footer__left-section">
    <div class="mdl-logo">FPGA Tomu (Fomu) Workshop</div>
    <div>
      <ul>
        

        <!-- This is to still take up space when none of the links above are shown in the footer -->
        <li style="visibility: hidden;">
          a
        </li>
      </ul>
    </div>
  </div>

  <div class="mdl-mini-footer__right-section">
    <div>&copy; Copyright 2019, Tomu Project Authors.</div>
    <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a>
      5.3.0 using <a
        href="https://github.com/SymbiFlow/sphinx_symbiflow_theme">sphinx_symbiflow_theme</a>.</div>
  </div>
</footer>
        </main>
    </div>
  </body>
</html>