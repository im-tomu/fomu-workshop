<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>Wishbone bridge between Renode and Fomu &#8212; FPGA Tomu (Fomu) Workshop  documentation</title>

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/material-icons.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/session.css" />
    <link rel="stylesheet" href="_static/notosanscjkjp.css" type="text/css" />
    <link rel="stylesheet" href="_static/roboto.css" type="text/css" />
    <link rel="stylesheet" href="_static/material-design-lite-1.3.0/material.blue-orange.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx_symbiflow_theme.css" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/sphinx_symbiflow_theme.js"></script>
    <link rel="shortcut icon" href="_static/icon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Renode Co-simulation using Verilator" href="renode-verilator.html" />
    <link rel="prev" title="Running your own Zephyr binary on LiteX/VexRiscv in Renode" href="renode-zephyr.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="renode.html">Working with LiteX and (co-)simulation with Renode</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active">Wishbone bridge between Renode and Fomu</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
            <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="_sources/renode-bridge.rst.txt" rel="nofollow">
<i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
          <a  class="mdl-navigation__link" href="index.html">
                  <i class="material-icons navigation-link-icon">home</i>
                  Workshop Home
              </a>
          
              <a  class="mdl-navigation__link" href="https://fomu.im">
                  <i class="material-icons navigation-link-icon">web</i>
                  Website
              </a>
          
              <a  class="mdl-navigation__link" href="https://github.com/im-tomu/fomu-workshop">
                  <i class="material-icons navigation-link-icon">code</i>
                  GitHub
              </a>
          
              <a  class="mdl-navigation__link" href="https://github.com/im-tomu/fomu-workshop/issues/new">
                  <i class="material-icons navigation-link-icon">bug_report</i>
                  Report Issue
              </a>
          
              <a  class="mdl-navigation__link" href="https://j.mp/fomu-cs">
                  <i class="material-icons navigation-link-icon">shopping_cart</i>
                  Buy
              </a>
          <a  class="mdl-navigation__link" href="help.html">
                  <i class="material-icons navigation-link-icon">live_help</i>
                  Contact
              </a>
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="index.html">
              <img class="logo" src="_static/logo.png" alt="FPGA Tomu (Fomu) Workshop"/>
          </a>
      </span>
    
<div class="globaltoc">
  <span class="mdl-layout-title toc">Table Of Contents</span>
  
  
      
      <nav class="mdl-navigation">
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements/index.html">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements/files.html">Required Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/software.html">Required Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/hardware.html">Required Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/drivers.html">Required Drivers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python on Fomu</a></li>
<li class="toctree-l1"><a class="reference internal" href="riscv.html">Fomu as a CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="hdl.html">Hardware Description Languages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="verilog.html">Verilog on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl.html">VHDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed-hdl.html">Mixed HDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="migen.html">Migen and LiteX</a></li>
<li class="toctree-l2"><a class="reference internal" href="icestudio.html">Fomu on IceStudio <em>Nightly</em></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="renode.html">Working with LiteX and (co-)simulation with Renode</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="renode-starting.html">Getting Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-zephyr.html">Running your own Zephyr binary on LiteX/VexRiscv in Renode</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Wishbone bridge between Renode and Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-verilator.html">Renode Co-simulation using Verilator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bootloader.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
</ul>

      </nav>
  
  </div>

</header>
        <main class="mdl-layout__content" tabIndex="0">
<header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="index.html">
              <img class="logo" src="_static/logo.png" alt="FPGA Tomu (Fomu) Workshop"/>
          </a>
      </span>
    
<div class="globaltoc">
  <span class="mdl-layout-title toc">Table Of Contents</span>
  
  
      
      <nav class="mdl-navigation">
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements/index.html">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements/files.html">Required Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/software.html">Required Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/hardware.html">Required Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements/drivers.html">Required Drivers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python on Fomu</a></li>
<li class="toctree-l1"><a class="reference internal" href="riscv.html">Fomu as a CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="hdl.html">Hardware Description Languages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="verilog.html">Verilog on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl.html">VHDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed-hdl.html">Mixed HDL on Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="migen.html">Migen and LiteX</a></li>
<li class="toctree-l2"><a class="reference internal" href="icestudio.html">Fomu on IceStudio <em>Nightly</em></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="renode.html">Working with LiteX and (co-)simulation with Renode</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="renode-starting.html">Getting Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-zephyr.html">Running your own Zephyr binary on LiteX/VexRiscv in Renode</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Wishbone bridge between Renode and Fomu</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode-verilator.html">Renode Co-simulation using Verilator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bootloader.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting Help</a></li>
</ul>

      </nav>
  
  </div>

</header>

    <div class="document">
        <div class="page-content">
        
  <section id="wishbone-bridge-between-renode-and-fomu">
<h1>Wishbone bridge between Renode and Fomu<a class="headerlink" href="#wishbone-bridge-between-renode-and-fomu" title="Permalink to this heading">¶</a></h1>
<p>This part of the workshop is based on a <a class="reference external" href="https://renode.readthedocs.io/en/latest/tutorials/fomu-example.html">Renode, Fomu and Etherbone
bridge
example</a>
from the Renode documentation.</p>
<p>Just like we can access Fomu peripherals using <code class="docutils literal notranslate"><span class="pre">wishbone-tool</span></code>, we can
also connect to a physical board from Renode, mapping a part of the
memory space to be accessible via the Etherbone protocol.</p>
<p>This is a very useful capability as it enables us to potentially
simulate an advanced LiteX SoC system which would not normally fit in
the FPGA (or e.g. take a long time to synthesize), and interface it with
the remaining part of the physical system for I/O.</p>
<section id="setting-up-the-server">
<h2>Setting up the server<a class="headerlink" href="#setting-up-the-server" title="Permalink to this heading">¶</a></h2>
<p>You can use <code class="docutils literal notranslate"><span class="pre">wishbone-tool</span></code> to bridge protocols such as USB to Etherbone.
To start the server, run the following command:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp" data-content="$ "></span>wishbone-tool<span class="w"> </span>-s<span class="w"> </span>wishbone
<span class="go" data-content="INFO [wishbone_tool::bridge::usb] opened USB device device 006 on bus 001
"></span></pre></div>
</div>
<p>This starts an Etherbone server on <code class="docutils literal notranslate"><span class="pre">localhost:1234</span></code> by default.  See
<code class="docutils literal notranslate"><span class="pre">wishbone-tool</span> <span class="pre">--help</span></code> to change these settings.</p>
<p>Now you can start Renode and setup the platform.</p>
</section>
<section id="connecting-from-renode">
<h2>Connecting from Renode<a class="headerlink" href="#connecting-from-renode" title="Permalink to this heading">¶</a></h2>
<p>Run <code class="docutils literal notranslate"><span class="pre">renode</span></code> and in the Monitor type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">monitor</span><span class="p">)</span> <span class="n">include</span> <span class="nd">@scripts</span><span class="o">/</span><span class="nb">complex</span><span class="o">/</span><span class="n">fomu</span><span class="o">/</span><span class="n">renode_etherbone_fomu</span><span class="o">.</span><span class="n">resc</span>
<span class="p">(</span><span class="n">machine</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span> <span class="n">start</span>
<span class="n">Starting</span> <span class="n">emulation</span><span class="o">...</span>
<span class="p">(</span><span class="n">machine</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span> <span class="n">sysbus</span> <span class="n">LogPeripheralAccess</span> <span class="n">sysbus</span><span class="o">.</span><span class="n">led</span>
</pre></div>
</div>
<p>You see a new window with a <a class="reference external" href="https://github.com/antmicro/zephyr/commit/29d8e51da15237f2a6bd2a3c8c97e004a66fc97a">shell
application</a>,
that provides additional commands allowing you to control LEDs on Fomu.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp" data-content="uart:~$ "></span>led_toggle
<span class="gp" data-content="uart:~$ "></span>led_breathe
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">led_toggle</span></code> command controls the LED by turning it on and off.
<code class="docutils literal notranslate"><span class="pre">led_breathe</span></code> makes the LED fade slowly in and out, creating a
“breathe” effect.</p>
<p>The script you loaded configures Renode to log all communication with
Fomu. After issuing some commands in Zephyr’s shell you’ll see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8276</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000988</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x8</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x7</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8279</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000990</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x8</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8290</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000998</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xC8</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8298</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009A0</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x9</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8301</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009A8</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xBA</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8305</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009B0</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x8</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x6</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8308</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009B4</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x8</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x7</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8311</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009BC</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x5</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8314</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009C0</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x0</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8317</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009C4</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x6</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8321</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009C8</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x0</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8324</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009D0</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x2</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8327</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009D4</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x0</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8331</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009DC</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x3</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8334</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009E0</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x0</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8337</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009E8</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x1</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8341</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x400009F4</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xFF</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8344</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000A08</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xA</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8347</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000A0C</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0x0</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8350</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000A14</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x4</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xB</span><span class="o">.</span>
<span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">31.8353</span> <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">led</span><span class="p">:</span> <span class="p">[</span><span class="n">cpu</span><span class="p">:</span> <span class="mh">0x40000A18</span><span class="p">]</span> <span class="n">WriteUInt32</span> <span class="n">to</span> <span class="mh">0x0</span> <span class="p">(</span><span class="n">unknown</span><span class="p">),</span> <span class="n">value</span> <span class="mh">0xFF</span><span class="o">.</span>
</pre></div>
</div>
<p>You can interact with Fomu manually, via the Monitor. To do that, you
first need to find the name of the peripheral that serves the connection
to Fomu.</p>
<p>Type in <code class="docutils literal notranslate"><span class="pre">peripherals</span></code> to see a list of all the elements of the
emulated SoC. Look for <code class="docutils literal notranslate"><span class="pre">EtherBoneBridge</span></code> entry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(machine-0) peripherals
Available peripherals:
  sysbus (SystemBus)
  │
  ├── cpu (VexRiscv)
  │     Slot: 0
  │
  ├── ddr (MappedMemory)
  │     &lt;0x40000000, 0x4FFFFFFF&gt;
  │     &lt;0xC0000000, 0xCFFFFFFF&gt;
  │
  ├── eth (LiteX_Ethernet)
  │   │ &lt;0x60007800, 0x600078FF&gt;
  │   │ &lt;0xE0007800, 0xE00078FF&gt;
  │   │ &lt;0x30000000, 0x30001FFF&gt;
  │   │ &lt;0xB0000000, 0xB0001FFF&gt;
  │   │ &lt;0x60007000, 0x600077FF&gt;
  │   │ &lt;0xE0007000, 0xE00077FF&gt;
  │   │
  │   └── phy (EthernetPhysicalLayer)
  │         Address: 0
  │
  ├── flash_mem (MappedMemory)
  │     &lt;0x20000000, 0x21FFFFFF&gt;
  │     &lt;0xA0000000, 0xA1FFFFFF&gt;
  │
  ├── led (EtherBoneBridge)
  │     &lt;0xE0006800, 0xE00068FF&gt;
  │
  ├── mem (MappedMemory)
  │     &lt;0x00000000, 0x0003FFFF&gt;
  │     &lt;0x80000000, 0x8003FFFF&gt;
  │
  ├── spi (LiteX_SPI_Flash)
  │   │ &lt;0x60005000, 0x6000500F&gt;
  │   │ &lt;0xE0005000, 0xE000500F&gt;
  │   │
  │   └── flash (Micron_MT25Q)
  │
  ├── sram (MappedMemory)
  │     &lt;0x10000000, 0x1003FFFF&gt;
  │     &lt;0x90000000, 0x9003FFFF&gt;
  │
  ├── timer0 (LiteX_Timer)
  │     &lt;0x60002800, 0x60002843&gt;
  │     &lt;0xE0002800, 0xE0002843&gt;
  │
  └── uart (LiteX_UART)
        &lt;0x60001800, 0x600018FF&gt;
        &lt;0xE0001800, 0xE00018FF&gt;
</pre></div>
</div>
<p>The device that acts as a connector to Fomu is called <code class="docutils literal notranslate"><span class="pre">led</span></code> and is
registered at <code class="docutils literal notranslate"><span class="pre">0xE0006800</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── led (EtherBoneBridge)
│     &lt;0xE0006800, 0xE00068FF&gt;
</pre></div>
</div>
<p>You can either use a full or relative address (via the <code class="docutils literal notranslate"><span class="pre">sysbus</span></code> or
<code class="docutils literal notranslate"><span class="pre">led</span></code> objects, respectively) to communicate with the physical LED
controller:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">machine</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span> <span class="n">sysbus</span> <span class="n">WriteDoubleWord</span> <span class="mh">0xE0006804</span> <span class="mh">0x1234</span> <span class="c1"># writes 0x1234 to the given address</span>
<span class="p">(</span><span class="n">machine</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span> <span class="n">led</span> <span class="n">WriteDoubleWord</span> <span class="mh">0x4</span> <span class="mh">0x4321</span> <span class="c1"># writes 0x4321 to 0xE0006800 + 0x4</span>
</pre></div>
</div>
<p>Note: the above values are just an example and won’t change the LED
status in any visible way. If you want to enable “breathe” effect
directly from the Monitor, see the necessary sequence in <a class="reference external" href="https://github.com/antmicro/zephyr/commit/29d8e51da15237f2a6bd2a3c8c97e004a66fc97a">the
application source
code</a>.</p>
</section>
</section>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
<div class="localtoc">
    <p class="caption">
      <span class="caption-text">Table Of Contents</span>
    </p>
    <ul>
<li><a class="reference internal" href="#">Wishbone bridge between Renode and Fomu</a><ul>
<li><a class="reference internal" href="#setting-up-the-server">Setting up the server</a></li>
<li><a class="reference internal" href="#connecting-from-renode">Connecting from Renode</a></li>
</ul>
</li>
</ul>

</div>
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="renode-zephyr.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L material-icons">arrow_back</i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>Running your own Zephyr binary on LiteX/VexRiscv in Renode</div>
         </div>
     </a>
     <a id="button-next" href="renode-verilator.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
        <i class="pagenation-arrow-R material-icons">arrow_forward</i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>Renode Co-simulation using Verilator</div>
        </div>
     </a>
</div>
        <footer class="mdl-mini-footer">
  <div class="mdl-mini-footer__left-section">
    <div class="mdl-logo">FPGA Tomu (Fomu) Workshop</div>
    <div>
      <ul>
        

        <!-- This is to still take up space when none of the links above are shown in the footer -->
        <li style="visibility: hidden;">
          a
        </li>
      </ul>
    </div>
  </div>

  <div class="mdl-mini-footer__right-section">
    <div>&copy; Copyright 2019, Tomu Project Authors.</div>
    <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a>
      5.3.0 using <a
        href="https://github.com/SymbiFlow/sphinx_symbiflow_theme">sphinx_symbiflow_theme</a>.</div>
  </div>
</footer>
        </main>
    </div>
  </body>
</html>